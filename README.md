# Windows向けPython機械学習ジョブ管理ツール

このリポジトリには、Windows環境でPythonベースの機械学習ジョブを順番に実行・管理するためのシンプルなツール `job_manager.py` が含まれています。ジョブはキューに追加された順番で処理され、完了・エラー時には通知が行われます。実行中でも新しいジョブを追加できるように設計されています。

## 主な機能

- キューに追加されたジョブを先頭から順に実行
- ジョブが完了すると次のジョブを自動的に開始
- ジョブがエラーになった場合はログを記録し、次のジョブに進行
- 完了・エラー時に通知（Windowsでは `win10toast` が利用可能な場合トースト通知、それ以外は標準出力）
- 実行中でも新しいジョブを追加可能
- 実行履歴を確認可能（成功・失敗・起動エラーを区別）

## 使い方

1. Python 3.9 以降で `job_manager.py` を実行します。

   ```powershell
   python job_manager.py
   ```

2. プロンプトが表示されたら、以下のコマンドで操作します。

   | コマンド | 例 | 説明 |
   |----------|----|------|
   | `add` | `add -n train --venv C:\venvs\ml --env CUDA_VISIBLE_DEVICES=0 -- python train.py --epochs 10` | ジョブを追加します。`--` 以降が実行コマンドです。`-n/--name` で表示名、`-c/--cwd` でワーキングディレクトリ、`--venv` で仮想環境のパス、`-e/--env` で環境変数 (`KEY=VALUE`) を指定できます。複数の `-e` を指定可能です。 |
   | `list` | `list` | キュー内のジョブと現在実行中のジョブを表示します。 |
   | `history` | `history -n 5` | 最近完了したジョブの履歴を表示します。`-n` で件数を指定可能です。 |
   | `exit` / `quit` | `exit` | マネージャを終了します。 |

3. 追加されたジョブは `logs/` ディレクトリ以下にログファイルを生成します。実行状況は `job_manager.log` でも確認できます。

### 通知について

- Windows環境で `win10toast` がインストールされている場合はトースト通知を表示します。
- ライブラリが使用できない場合、またはWindows以外の環境では標準出力に通知メッセージを表示します。

### 注意点

- `add` コマンドで実行するコマンドは、Windows PowerShell/コマンドプロンプトで動作する形式で指定してください。
- `--venv` に仮想環境を指定した場合、`PATH` と `VIRTUAL_ENV` を上書きして実行します。コマンドの先頭が `python` / `python.exe` のときは仮想環境内のPythonに自動で置き換わります。
- 強制終了したい場合は、`Ctrl+C` でマネージャを終了できます。実行中ジョブの停止は対象プロセスに依存します。

## 開発

コードは単一ファイル `job_manager.py` で構成されています。必要に応じて拡張（Web UI の追加、永続化ストレージ対応など）を行ってください。
